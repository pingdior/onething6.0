# OneThing AI任务管理应用

这是一个基于AI辅助的个人目标达成伙伴应用，帮助用户更有效地管理目标、任务和情绪。


## 主要功能

- 📋 智能目标管理与分解
  - 目标设定与截止日期管理
  - 子目标创建与进度追踪
  - 目标优先级排序
  - 完成度可视化展示
- 📆 每日任务规划与追踪
  - 任务创建与管理
  - 时间线与看板视图
  - 任务完成状态追踪
  - 与目标关联功能
  - 任务编辑、删除和AI分析
- 📊 目标复盘与分析
  - 周期性复盘报告
  - 目标进展追踪
  - 时间效率分析
  - 个性化改进建议
- 🧠 情绪监测与干预建议
  - 情绪记录与追踪
  - 情绪趋势分析
  - 情绪与目标/任务关联分析
  - 情绪分布可视化
- 🤖 智能AI伴侣助手
  - 自然语言添加任务
  - 上下文记忆对话
  - 情境感知建议
  - 智能提醒功能
  - 聊天记录持久化存储
- 🔄 自动任务调整与提醒

## 功能更新

- **API 故障切换增强**: 修复了当主 AI 服务 (DeepSeek) 不可用时，切换到备用 AI 服务 (SiliconFlow) 失败的问题。现在系统会在调用备用服务时自动包含必需的 `model` 参数。注意：需要在 `server.js` 中手动配置正确的 SiliconFlow 模型名称。
- **AI 服务调用修复**: 修复了后端调用主、备 AI API 时因模型名称错误导致失败的问题。现在后端会根据目标 API 动态设置正确的模型名称。前端不再发送硬编码的模型信息。

## 技术栈

- **前端**: React + TypeScript + Tailwind CSS
- **状态管理**: Zustand
- **AI集成**: DeepSeek API / OpenAI API
- **后端**: Node.js + Express
- **数据存储**: 本地状态 + localStorage持久化 (后续会集成数据库)
- **国际化**: i18next + React-i18next
- **响应式设计**: 移动端优化CSS + 设备检测

## UI设计资源

OneThing使用专门设计的移动端UI组件库，位于`src/assets`目录，资源包括：

### 颜色主题

主题颜色定义在`theme-colors.js`中：
- **主色**: #4ECDC4 (青绿色)
- **辅助色**: #A6E4D0 (浅绿色)
- **中性色**: #1A535C (深青色)
- **点缀色**: #FF6B6B (珊瑚红)
- **文字颜色**: #374151, #4B5563, #6B7280
- **背景色**: #F3F4F6, #FEF7FF

### 图标和UI元素

- 导航图标：首页、任务、设置等
- 功能按钮：主要按钮、次要按钮、警告按钮
- 容器背景：卡片容器、输入框背景

### 使用方法

```jsx
// 导入颜色主题
import themeColors from '../assets/theme-colors';

// 导入SVG图标
import { ReactComponent as LogoIcon } from '../assets/icons/logo.svg';

// 预览所有UI组件
import MobileUIKit from '../components/mobile/MobileUIKit';
```

## 快速开始

1. 安装依赖:
```bash
git clone https://github.com/yourusername/onething.git
cd onething
npm install
```

2. 配置环境变量:
```bash
# 复制环境变量示例文件
cp .env.example .env

# 编辑.env文件，填入你的API密钥
```
> 注意：`.env`文件包含敏感信息，如API密钥等，已在`.gitignore`中配置为不上传到代码仓库。请妥善保管你的API密钥，不要在公开场合分享。

3. 启动后端代理服务:
```bash
node server.js
```

4. 启动前端开发服务器:
```bash
npm start
```

5. 访问应用
前端: http://localhost:3000
GraphQL API: http://localhost:4000/graphql

## 移动端支持
OneThing支持响应式设计，同时适配桌面端和移动端。移动端版本经过特别优化，提供更适合触控操作的界面和交互。特别添加了底部导航栏、移动端专用样式和错误提示，确保在各种移动设备上都能获得出色的用户体验。

## 国际化支持
应用支持多语言切换功能，目前支持中文、英文和日文。系统会自动检测用户设备的语言设置并应用相应的界面语言，同时针对不同语言优化了字体和界面布局，确保在任何语言下都能获得最佳显示效果。

## 功能亮点

### 任务管理增强
- 完整的任务CRUD操作支持
- 任务与AI讨论功能，获取智能分析和建议
- 时间线和看板双视图切换

### 聊天记录持久化
- 使用localStorage保存聊天历史
- 页面刷新和切换后保持对话记忆
- 智能加载之前的对话上下文

### 情绪监测系统
- 支持记录七种基本情绪类型和强度
- 提供情绪趋势分析图表
- 情绪分布饼图展示
- 情绪与目标/任务关联分析

### AI伴侣增强功能
- 上下文记忆对话
- 基于用户情绪和目标推荐回复选项
- 通过自然语言创建任务
- 个性化互动和记忆存储

### 首次使用引导
- 交互式多步骤引导流程
- 直观展示核心功能
- 优化初次用户体验

### 任务与目标深度整合
- 任务可关联到目标
- 目标进度自动根据子目标完成情况更新
- 互联数据确保一致性

## 文件夹结构

```markdown
onething/
├── src/            # 前端源代码目录
│   ├── components/ # UI组件
│   ├── pages/      # 页面组件
│   ├── store/      # Zustand状态管理
│   ├── services/   # API服务
│   ├── i18n/       # 国际化配置和语言文件
│   ├── assets/     # UI资源(图标、按钮、颜色主题)
│   └── styles/     # 全局样式和移动端专用样式
├── schema/         # GraphQL schema文件
├── scripts/        # 脚本文件
├── public/         # 静态资源
├── server.js       # 后端服务器入口
└── 其他配置文件...
```

## 常见问题解答

### 如何添加新目标?
在目标页面点击"新建目标"按钮，填写目标详细信息后保存即可。

### 如何通过AI助手创建任务?
在AI伴侣对话框中，使用自然语言描述任务，例如"创建任务：明天上午完成项目报告"，AI会自动识别并创建任务。

### 如何编辑或删除任务?
在任务项上悬停时会显示操作菜单，点击"编辑"或"删除"按钮即可。在看板视图中，也可以直接点击对应的操作按钮。

### 如何使用AI分析任务?
点击任务的"与AI讨论"按钮，系统会自动将任务信息发送给AI伴侣进行分析，并提供执行建议。

### 如何查看情绪分析?
在情绪页面可以查看情绪趋势图和分布图，记录日常情绪变化并获取分析洞察。

### 如何生成复盘报告?
在复盘页面选择时间范围（周/月/自定义），点击"生成新复盘"按钮即可创建复盘报告。

### 为什么我的移动设备无法连接AI服务?
如果遇到AI服务连接问题，请确保您的网络连接正常，并尝试刷新页面。如果问题持续存在，可以点击错误提示中的"重试"按钮，或检查服务器是否正常运行。

## 贡献者

- OneThing开发团队
- 创业者Gaya（测试用例提供）
- Claude 3.7 Sonnet (AI辅助开发)

## 版本记录
### v6.0.9 (2025-04-08)
- 修复了因修改 `addTask` 函数签名（要求传入 `date`）导致的 TypeScript 编译错误：
  - 更新 `AddTaskModal.tsx` 以接收 `selectedDate` prop 并将其传递给 `addTask`。
  - 更新 `Tasks.tsx` 以传递 `selectedDate` 给 `AddTaskModal`。
  - 更新 `ChatSidebar.tsx` 以在通过聊天创建任务时自动添加当前日期。
- 移除了 `Tasks.tsx` 中未使用的 `useEffect` 和 `format` 导入。

### v6.0.8 (2025-04-08)
- **改进任务页面日期功能**: 
  - 任务页面 (`Tasks.tsx`) 不再显示硬编码日期，而是默认显示当前日期。
  - 添加了 MUI DatePicker 组件，允许用户选择查看其他日期的任务。
  - 添加了"今天"按钮，方便用户快速返回当前日期的视图。
  - 任务列表现在会根据选定的日期进行过滤。
  - 更新了 `Task` 类型 (`taskStore.ts`)，添加了 `date` 属性以支持按日期筛选任务。
  - 添加了当选定日期/时间段无任务时的提示文本 (需补充i18n翻译键: `common.today`, `tasks.noTasksMorning`, `tasks.noTasksAfternoon`, `tasks.noTasksTodo`, `tasks.noTasksInProgress`, `tasks.noTasksCompleted`)。

### v6.0.7 (2025-04-08)
- 修复了创建新目标模态框（`AddGoalModal.tsx`）的国际化问题，确保所有步骤、标签、提示和按钮文本都能正确显示为当前选择的语言。
- 在翻译文件中补充了 `AddGoalModal` 组件所需的所有翻译键。

### v6.0.6 (2025-04-07)
- 进一步修复国际化(i18n)问题，确保所有模块（包括目标管理、情绪记录弹窗、AI伴侣侧边栏）完全适配多语言。
- 修复目标管理页面的筛选和排序选项的硬编码文本。
- 修复情绪记录弹窗中的情绪选项、强度标签、关联事件按钮等的硬编码文本。
- 修复AI伴侣侧边栏标题、错误提示、加载状态和输入框占位符的硬编码文本。
- 确认日期格式化函数在所有相关组件中均使用当前语言环境。

### v6.0.5 (2025-04-04)
- 全面修复国际化(i18n)功能，解决多组件中存在的硬编码中文问题
- 修复Review复盘模块的多语言显示，完善所有UI文本的翻译
- 修复Emotion情绪模块的多语言支持，添加缺失的翻译键
- 优化日期和时间格式化函数，使用当前语言环境正确显示
- 确保所有模态框和弹窗组件内容在切换语言时能正确显示

### v6.0.4 (2025-03-26)
- 全面优化移动端UI设计，实现更符合移动设备使用习惯的界面
- 修复移动端无法连接AI服务的问题
- 增强国际化支持，优化系统语言自动检测和切换
- 添加AI服务连接状态监控和错误提示
- 更新响应式设计，确保在各类移动设备上的最佳显示效果

### v6.0.3 (2025-03-25)
- 修复 Nginx 配置中的重定向循环问题
- 优化 GitHub Actions 部署流程，添加 NODE_ENV 环境变量配置
- 完善 PM2 进程管理配置，解决端口冲突问题
- 更新 DeepSeek API 密钥配置流程
- 改进服务器部署文档和调试记录

### v6.0.2 (2025-03-22)
- 解决React 19与react-beautiful-dnd的严重兼容性问题
- 新增服务状态监控组件，提高系统稳定性
- 重构任务列表组件，优化渲染性能
- 添加新的调试记录文档，方便追踪问题解决过程

### v6.0.1 (2025-03-21)
- 修复任务页面按钮功能问题
- 实现聊天记录持久化
- 添加任务与AI讨论功能
- 改进错误处理和日志

### v6.0.0 (2025-03-20)
- 新增首次使用引导功能
- 实现情绪监测系统
- 增强AI伴侣能力
- 完成复盘功能

### v5.0.0 (2025-03-15)
- 实现目标管理系统
- 任务管理系统重构
- 改进用户界面
- 添加示例数据

## 许可证

MIT © OneThing团队, 2025 